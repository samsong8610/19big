<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>十九大知识你知道多少？快来试试看！</title>
<meta name="description" content="十九大知识你知道多少？快来试试看！">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<script type="text/javascript" src="http://img.cankaoxiaoxi.com/js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
<script>
	(function () {
		var config_jsapi = function () {
			var url = location.href.split("#")[0];
			url = url.replace("&", "%26");
			$.getJSON('/jsapi/sign?url=' + url, function (json) {
				console.log("sign " + url + " for jsapi: " + JSON.stringify(json))
				if (json) {
					wx.config({
						debug: false,
						appId: json.appId,
						timestamp: json.timestamp,
						nonceStr: json.nonceStr,
						signature: json.signature,
						jsApiList: [
							"onMenuShareAppMessage",
							"onMenuShareTimeline",
							"onMenuShareQQ",
							"onMenuShareQZone",
							"showOptionMenu"// 所有要调用的 API 都要加到这个列表中
						]
					});

					wx.ready(function () {
						wx.showOptionMenu();
						wx.onMenuShareTimeline({
							title: document.title, // 分享标题
							link: json.url, // 分享链接
							imgUrl: decodeURIComponent(window.headimgurl), // 分享图标
							success: function () {
								console.log('share to Timeline success');
							},
							cancel: function () {
								console.log('cancel share to Timeline');
							}
						});

						wx.onMenuShareAppMessage({
							title: document.title, // 分享标题
							desc: '快来刷新你的记录吧！', // 分享描述
							link: json.url, // 分享链接
							imgUrl: decodeURIComponent(window.headimgurl), // 分享图标
							type: '', // 分享类型,music、video或link，不填默认为link
							dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
							success: function () {
								console.log('share to AppMessage success');
							},
							cancel: function () {
								console.log('cancel share to AppMessage');
							}
						});
						wx.onMenuShareQQ({
							title: document.title, // 分享标题
							desc: '快来刷新你的记录吧！', // 分享描述
							link: json.url, // 分享链接
							imgUrl: decodeURIComponent(window.headimgurl), // 分享图标
							success: function () {
								console.log('share to QQ success');
							},
							cancel: function () {
								console.log('cancel share to QQ');
							}
						});

						wx.onMenuShareQZone({
							title: document.title, // 分享标题
							desc: '快来刷新你的记录吧！', // 分享描述
							link: json.url, // 分享链接
							imgUrl: decodeURIComponent(window.headimgurl), // 分享图标
							success: function () {
								console.log('share to QZone success');
							},
							cancel: function () {
								console.log('cancel share to QZone');
							}
						});
					});
					wx.error(res => {
						console.log('WxConfig error: ' + JSON.stringify(res));
					});
				}
			});
		}
		window.headimgurl = "http://image.cmlzw.net/19da/fenxiang-thumb.jpg"
		$.get('/userinfo').done((data, status, xhr) => {
			window.nickname = data.nickname;
			window.openid = data.openid;
			window.username = data.username;
			window.phoneNum = data.phone;
			window.organizationId = data.organizationId;
			config_jsapi();
		}).fail((xhr, status, err) => {
			console.log(`get userinfo failed: ${status}(${xhr.status})`)
			if (xhr.status === 401) {
				if (navigator.userAgent.match(/MicroMessenger/i)) {
					location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxffcf430ee87dea58&redirect_uri=http%3a%2f%2f19da.cmlzw.net%2fauth%2fwechat&response_type=code&scope=snsapi_login&connect_redirect=1#wechat_redirect";
				} else {
					location.href="/auth/wechat?scope=snsapi_login_qrconnect"
				}
			} else {
				console.log(JSON.stringify(err));
			}
		});
	})();

</script>
<style>

*{outline: none;-webkit-tap-highlight-color: rgba(0,0,0,0);tap-highlight-color: rgba(0,0,0,0);-ms-tap-highlight-color: rgba(0,0,0,0);-o-tap-highlight-color: rgba(0,0,0,0);-moz-tap-highlight-color: rgba(0,0,0,0);}
@charset "utf-8";

body {margin:0; height:100%; font-size:0.4rem;}
h1,h2,h3,h4,h5 {margin: 0;font-weight: normal;}
div,p,img,
ul,ol,li, 
dl,dt,dd, 
table,th,td, 
form {margin: 0;padding: 0;}
img {border: 0; vertical-align: top;}
ul li{list-style:none; }
a {text-decoration: none;}
a:hover {text-decoration: none;}


* {margin:0; padding:0;}
body>a {display:none;}
.ov {overflow:hidden; zoom:1;}
.wrap {width:100%; overflow:hidden; position:relative;font-family:"华文细黑";background-size: cover;}
.box01 { background-size:100% auto; height:100%; width:100%; position:absolute; left:0; top:0; z-index:3; background:url(http://image.cmlzw.net/19da/1-bg.jpg) 0 0/100% 100% no-repeat;}
.box01 .btn {position:absolute; bottom:0.5rem; width:3.8rem; left:40%; margin-left:-1.9rem; height:1.3rem; background:url(http://image.cmlzw.net/19da/1-button.png) center center/auto auto no-repeat }
.box01 .checkBoard {position:absolute; bottom:0.6rem; width:1rem; height:1rem; left:auto; right: 10%; background:url(http://image.cmlzw.net/19da/1-board.png) 0 0/100% 100% no-repeat }

.box05 {position:absolute; left:0; top:0; width:100%; height:100%; background:url(http://image.cmlzw.net/19da/2-bg.jpg) 0 0/100% 100% no-repeat;}
.box05 ul {margin: 0.2rem auto;}
.box05 ul li {margin-bottom:0.8rem; text-align:center; height:0.9rem;}
.box05 ul img {width:50%;}

.box02 {position:absolute; left:0; top:0; width:100%; height:100%; background:url(http://image.cmlzw.net/19da/3-bg.jpg) 0 0/100% 100% no-repeat;}
.box02 .time {margin: 0.7rem auto; width: 90%; height:0.6rem; background:#fff; border-radius: 0.4rem; border: 3px solid rgb(240,184,97); line-height:0.6rem;}
.box02 .time .remain {float:left; width:0%; height:0.48rem; background:#cd1100; line-height:0.48rem; text-indent:0.2rem; margin-top:3px; margin-left:5px; border-radius:10px; position:relative;}
.box02 .time .remain>span {width:1.2rem; height:0.34rem; position:absolute; font-size:0.32rem; color:#fff;}
.box02 .time .right {float:right; width:12%; color:rgb(198,13,18);}
.box02 .time .jishi {position:absolute; top:-0.44rem; right:-0.7rem;}
.box02 .time .jishi img {}
.box02 .question {width:90%; margin:0.4rem auto; color:#fff; min-height: 2rem;}
.box02 .flist {width:6.4rem; margin:0.4rem auto;}
.box02 .flist ul li {position:relative; width:2.5rem; height:1.2rem; background:url(http://image.cmlzw.net/19da/3-option-bg.png) 0 0/100% 100% no-repeat; float:left; margin-bottom:0.4rem; padding:0.9rem 0.25rem; text-align:center; box-shadow: 0 0 0.2rem #888; transition: all 0.3s linear; transform-origin: 0 0; transform-style: preserve-3d; color:rgb(136,76,76); font-weight:bold;}
.box02 .flist ul li:nth-child(2n+1) {margin-right:0.4rem;}
.box02 .flist ul li.cor {background-image:url(http://image.cmlzw.net/19da/3-option-right.png); box-shadow:none;}
.box02 .flist ul li .correct {position:absolute; width:100%; height:100%; top:0; left:0; background:url(http://image.cmlzw.net/19da/3-dui.png) 0 0/100% 100% no-repeat; /*display:none; */transition: all 0.3s linear; transform-origin: 0 0; transform: rotateX(90deg) translateY(0px);}
.box02 .flist ul li .error {position:absolute; width:100%; height:100%; top:0; left:0; background:url(http://image.cmlzw.net/19da/3-cuo.png) 0 0/100% 100% no-repeat; /*display:none;*/ transition: all 0.3s linear; transform-origin: 0 0; transform: rotateX(90deg) translateY(0px);}
.box02 .flist ul li .tip {margin-left: 100px; line-height: 38px; color: rgb(186,15,24); font-family: arial; font-weight: bold; opacity:0; transition:all 0.3s linear;}

.box03 {position:absolute; left:0; top:0; width:100%; height:100%;}
.box03 .mask {position:absolute; left:0; top:0; width:100%; height:100%; background:url(http://image.cmlzw.net/19da/4-bg.jpg) 0 0/100% 100% no-repeat;}
.box03 .mask2 {position:absolute; left:0; top:0; width:100%; height:100%; background:rgba(0,0,0,0.8); display:none;}
.box03 .tip {position:absolute; width:90%; height:10rem; left:5%; top:2rem; background:url(http://image.cmlzw.net/19da/4-title.png) 0 0/100% no-repeat;}
.box03 .tip>span {position:absolute; color:#ffba00; font-size:0.8rem; }
.box03 .tip .percent {left:49%; top:3%; font-family:arial; font-weight:bold;}
.box03 .tip .honor {left:31%; top:17%; font-size:0.6rem; font-weight:bold;}
.box03 .tip .text {left:9%; top:65%; text-align:center; width:79%; font-size:0.48rem; font-weight: bold; color: black;}
.box03 .buttons {position:absolute; bottom:2rem; width:80%; left:10%;}
.box03 .buttons>div {margin-bottom:0.3rem; width:100%; height:1rem;}
.box03 .buttons>div>span {display: inline-block; width: 50%; height: 1rem;}
.box03 .again {background:url(http://image.cmlzw.net/19da/4-again.png) 0 0/100% no-repeat;}
.box03 .fx {background:url(http://image.cmlzw.net/19da/4-fx.png) 0 0/100% no-repeat;}
.box03 .qiandao {background:url(http://image.cmlzw.net/19da/4-qiandao.png) 0 0/100% no-repeat;}
.box03 .qiandao.disabled {-webkit-filter: grayscale(100%) contrast(30%); -moz-filter: grayscale(100%) contrast(30%); -o-filter: grayscale(100%) contrast(30%); -ms-filter: grayscale(100%) contrast(30%); filter: grayscale(100%) contrast(30%);}
.box03 .board {background:url(http://image.cmlzw.net/19da/4-board.png) 0 0/100% no-repeat;}
.box03 .fxtips {position:absolute; top:0; right:0; width:3.6rem; height:2.1rem; display:none;}
.box03 .fxtips img {width:100%; height:100%; }
.box03 .copyright {position:absolute; bottom:0.3rem; color:#fff; opacity:0.7; width:100%;}
.box03 .copyright p {text-align:center; display: none;}

.box06 { background-size:100% auto; height:100%; width:100%; position:absolute; left:0; top:0; background:url(http://image.cmlzw.net/19da/5-bg.jpg) 0 0/100% 100% no-repeat;color: white; font-weight: bold;}
.box06 form {margin: 2.5rem auto 0.5rem auto; width: 90%;}
.box06 form label {display: block;}
.box06 form span.phoneError {color: red;}
.box06 form input {height: 1rem; font-size: large;}
.box06 form select {height: 1rem; font-size: large; width: 100%;}
.box06 .buttons {margin: 0 auto; width: 80%; text-align: center;}
.box06 .buttons span {display: inline-block;}
.box06 .buttons span img {width: 2rem;}

.box07 { background-size:100% auto; height:100%; width:100%; position:absolute; left:0; top:0; background:url(http://image.cmlzw.net/19da/6-bg1.jpg) 0 0/100% 100% no-repeat;color: black;}
.box07 span {display: inline-block;}
.box07.zuzhi {background-image: url(http://image.cmlzw.net/19da/6-bg-zuzhi1.jpg);}
#tabSwitch {margin: 31% 10% 0 10%; height: 6%;}
#tabSwitch span {width: 50%; height: 100%;}
.box07 .roller {margin-top: 5.3%; margin-left: 2%; height: 53%; overflow: scroll;}
.box07 .roller div {position: relative; width: 33%; float: left;}
.box07 .roller h3 {font-weight: bold;}
.box07 .roller h3 img {height: 0.7rem;}
.box07 ol {list-style: none;}
.box07 li {font-size: 70%;}
.box07 .roller li {text-align: center;}
.box07 .roller ol li span {display: inline;}
.box07 .roller span.nickname {width: 80%;}
.box07 .roller span.score {width: 20%;}
.box07 .buttons {position: absolute; left: 17%; right: 3%; bottom: 0.15rem; width: 80%; text-align: right;}
.box07 .buttons img {width: 2rem;}
.box07 .orgRoller {margin-top: 5.3%; margin-left: 15%; height: 61%; overflow: scroll;}
.box07 .orgRoller .seq {width: 10%; vertical-align: top;}
.box07 .orgRoller .nickname {width: 60%;}
.box07 .orgRoller .score {width: 30%; vertical-align: top;}

#message {position:absolute; left:0; top:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index: 10;}
#message p {margin: 50% 0.5rem 0 0.5rem; color: white; font-weight: bold;}

.test {position:absolute; width:100%; bottom:0.2rem; color:#000; font-size:0.28rem; z-index:100; display:none;}
.music {position:absolute; width:0.6rem; height:0.6rem; top:0.2rem; right:0.2rem; background:url(http://image.cmlzw.net/19da/music_start.png) 0 0/100% auto no-repeat; z-index:100;}
</style>
</head>

<body>
<div class="test"></div>

<div class="wrap">
	<!-- 开始页begin -->
	<div class="box01" id="wbegin">
		<!-- <div class="fingers">
			<div class="left"></div>
			<div class="right"></div>
		</div> -->
		<div class="btn" id="start"></div>
		<div class="checkBoard" id="checkBoard"></div>
		
	</div>
	<!-- 开始页end -->
  
	<!-- 选择页begin -->
	<div class="box05" id="wbegin05" style="display:none;">
		<ul>
			<li id="start01"><img src="http://image.cmlzw.net/19da/2-xuemin.png" /></li>
			<li id="start02"><img src="http://image.cmlzw.net/19da/2-xueba.png" /></li>
			<li id="start03"><img src="http://image.cmlzw.net/19da/2-xueshen.png" /></li>
		</ul>
	</div>
	<!-- 选择页end -->
	
  <!-- 游戏页begin 我国需要建设_____型、技能型、创新型的劳动者大军。-->
  <div class="box02" id="main"  style="display:none;">
      
	<div class="time">
		<div class="remain">
		<span>倒计时</span>
		<div class="jishi">
			<img src="http://image.cmlzw.net/19da/3-jishi.png" >
		</div>
		</div>
		<div class="right">
			<span class="num">0</span>s
		</div>
		
	</div>
	<div class="question" id="question"></div>
	<div  class="flist">
		<ul id="selects_box">
		  <li id='s_0' class="rect">知识<div class="correct"><span class="tip">+1s</span></div></li>
		  <li id='s_1' class="rect">密集<div class="error"></div></li>
		  <li id='s_2' class="rect">务实</li>
		  <li id='s_3' class="rect">我不知道</li>
		</ul>

	</div>

  </div>
  <!-- 游戏页end -->
  
	<!-- 结果页begin -->
	<div class="box03" id="wend"  style="display: none;">
		<div class="mask">
		
		</div>
		<div class="tip"><span class="percent">0</span><span class="honor">初级学民</span><span class="text">小胜别松懈，么么哒！</span></div>
		
		<div class="buttons">
			<div><span class="again"></span><span class="fx"></span></div>
			<div><span class="qiandao"></span><span class="board"></span></div>
			<!-- <div class="again"></div>
			<div class="fx"></div>
			<div class="qiandao"></div>
			<div class="board"></div> -->
		</div>
		<div class="mask2">
		
		</div>
		<div class="fxtips"><img src="http://image.cmlzw.net/19da/5-fxtips.png" /></div>
		<div class="copyright"><p>中共澄迈县纪委制作</p></div>
	</div>
	<!-- 结果页end -->
	<!-- 签到页begin -->
	<div class="box06" id="qiandao" style="display: none;">
		<form>
			<label for="phone">手机：</label>
			<input type="tel" name="phone" id="phone" placeholder="用于通知您领取廉政宣传品"><span id="phoneErr" class="phoneError"></span>
			<label for="org">党组织：</label>
			<select name="org" id="org">
				<option value="" selected>群众</option>
				<option value="1">金江镇党委</option>
				<option value="2">老城镇党委</option>
				<option value="3">大丰镇党委</option>
				<option value="4">瑞溪镇党委</option>
				<option value="5">永发镇党委</option>
				<option value="6">加乐镇党委</option>
				<option value="7">文儒镇党委</option>
				<option value="8">中兴镇党委</option>
				<option value="9">仁兴镇党委</option>
				<option value="10">福山镇党委</option>
				<option value="11">桥头镇党委</option>
				<option value="12">金安筹备组党委</option>
				<option value="13">县直属单位工委</option>
				<option value="14">老城开发区工委</option>
				<option value="15">金马物流工委、福山咖啡风情镇工委、琼台基地工委</option>
				<option value="16">县农业局党委</option>
				<option value="17">县财政局党委</option>
				<option value="18">县人社局党委</option>
				<option value="19">县教科局党委、澄迈中学党委</option>
				<option value="20">县文体局党委</option>
				<option value="21">县卫计委党委</option>
				<option value="22">县公安局党委</option>
				<option value="23">县住建系统党委</option>
				<option value="24">县交通局党委</option>
				<option value="25">县商务局党委</option>
				<option value="26">县水务局党委</option>
				<option value="27">县林业局党委</option>
				<option value="28">县工商局党委</option>
				<option value="29">县国税局党委</option>
				<option value="30">县地税局党委</option>
			</select>
		</form>
		<div class="buttons">
			<span class="return"><img src="http://image.cmlzw.net/19da/5-return.png" alt="返回"></span>
			<span class="submit"><img src="http://image.cmlzw.net/19da/5-submit.png" alt="提交"></span>
		</div>
	</div>
	<!-- 签到页end -->
	<!-- 排行榜begin -->
	<div class="box07" id="board" style="display: none;">
		<div id="tabSwitch"><span id="geren"></span><span id="zuzhi"></span></div>
		<div class="roller">
			<div>
				<!-- <h3><img src="http://image.cmlzw.net/19da/6-xuemin.png" alt="学民榜单"></h3> -->
				<ol id="xueminBoard">
					<!-- <li><span class="nickname">宋晓光(sam)</span><span class="score">(9)</span></li>
					<li><span class="nickname">宋晓光(sam)</span><span class="score">(9)</span></li>
					<li><span class="nickname">不要让我想名字</span><span class="score">(9)</span></li>
					<li><span class="nickname">宋晓光(sam)</span><span class="score">(9)</span></li> -->
				</ol>
			</div>
			<div>
				<!-- <h3><img src="http://image.cmlzw.net/19da/6-xueba.png" alt="学霸榜单"></h3> -->
				<ol id="xuebaBoard">
					<!-- <li><span class="nickname">宋晓光(sam)</span><span class="score">(9)</span></li>
					<li><span class="nickname">宋晓光(sam)</span><span class="score">(9)</span></li>
					<li><span class="nickname">宋晓光(sam)</span><span class="score">(9)</span></li>
					<li><span class="nickname">宋晓光(sam)</span><span class="score">(9)</span></li> -->
				</ol>
			</div>
			<div>
				<!-- <h3><img src="http://image.cmlzw.net/19da/6-xueshen.png" alt="学神榜单"></h3> -->
				<ol id="xueshenBoard">
					<!-- <li><span class="nickname">宋晓光(sam)</span><span class="score">(9)</span></li>
					<li><span class="nickname">宋晓光(sam)</span><span class="score">(9)</span></li>
					<li><span class="nickname">宋晓光(sam)</span><span class="score">(9)</span></li>
					<li><span class="nickname">宋晓光(sam)</span><span class="score">(9)</span></li> -->
				</ol>
			</div>
		</div>
		<div class="orgRoller" style="display: none;">
			<ol id="orgBoard">
				<!-- <li><span class="seq">1</span><span class="nickname">金江镇党委</span><span class="score">80%</span></li>
				<li><span class="seq">2</span><span class="nickname">瑞溪镇党委</span><span class="score">78%</span></li>
				<li><span class="seq">3</span><span class="nickname">县公安局党委</span><span class="score">75%</span></li> -->
			</ol>
		</div>
		<div class="buttons">
			<span class="return"><img src="http://image.cmlzw.net/19da/5-return.png" alt="返回"></span>
		</div>
	</div>
	<!-- 排行榜end -->

	<div id="message" style="display: none;"><p></p></div>
	<div class="music"></div>
</div>
<audio id="audioOver" preload="preload">
	<source src="http://image.cmlzw.net/19da/audio/over.mp3" type="audio/mpeg">
	<source src="http://image.cmlzw.net/19da/audio/over.ogg" type="audio/ogg">
</audio>
<audio id="audioRight" preload="preload">
	<source src="http://image.cmlzw.net/19da/audio/right.mp3" type="audio/mpeg">
	<source src="http://image.cmlzw.net/19da/audio/right.ogg" type="audio/ogg">
</audio>
<audio id="audioWrong" preload="preload">
	<source src="http://image.cmlzw.net/19da/audio/wrong.mp3" type="audio/mpeg">
	<source src="http://image.cmlzw.net/19da/audio/wrong.ogg" type="audio/ogg">
</audio>
<audio id="audioPlay" preload="preload">
	<source src="http://image.cmlzw.net/19da/audio/play.mp3" type="audio/mpeg">
	<source src="http://image.cmlzw.net/19da/audio/play.ogg" type="audio/ogg">
</audio>
<audio id="audioBg" loop="loop" preload="preload">
	<source src="http://image.cmlzw.net/19da/audio/bg.mp3" type="audio/mpeg">
	<source src="http://image.cmlzw.net/19da/audio/bg.ogg" type="audio/ogg">
</audio>

<script>
(function($){
		(function(){
			// var oA = document.createElement("a");
			// oA.href = "#";
			// oA.innerHTML = '<img src="http://count.cankaoxiaoxi.com/count.png?contentid=2217752" alt="count">';
			// document.body.appendChild(oA);
			// if(navigator.userAgent.match(/MicroMessenger/i)){
			// 	var weixinShareLogo = 'http://upload.cankaoxiaoxi.com/2017/1027/1509074165117.jpg';
			// 	$('body').prepend('<div style=" overflow:hidden; width:0px; height:0; margin:0 auto; position:absolute; top:-800px;"><img src="'+ weixinShareLogo +'"></div>')	
			// };
			var Dpr = 1, uAgent = window.navigator.userAgent;
			var isIOS = uAgent.match(/iphone/i);
			var isYIXIN = uAgent.match(/yixin/i);
			var is2345 = uAgent.match(/Mb2345/i);
			var ishaosou = uAgent.match(/mso_app/i);
			var isSogou = uAgent.match(/sogoumobilebrowser/ig);
			var isLiebao = uAgent.match(/liebaofast/i);
			var isGnbr = uAgent.match(/GNBR/i);
			function resizeRoot(){
				var wWidth = (screen.width > 0) ? (window.innerWidth >= screen.width || window.innerWidth == 0) ? screen.width : window.innerWidth : window.innerWidth, wDpr, wFsize;
				var wHeight = (screen.height > 0) ? (window.innerHeight >= screen.height || window.innerHeight == 0) ? screen.height : window.innerHeight : window.innerHeight;
				if (window.devicePixelRatio) {
					wDpr = window.devicePixelRatio;
				} else {
					wDpr = isIOS ? wWidth > 818 ? 3 : wWidth > 480 ? 2 : 1 : 1;
				}
				if(isIOS) {
					wWidth = screen.width;
					wHeight = screen.height;
				}
				// if(window.orientation==90||window.orientation==-90){
				//     wWidth = wHeight;
				// }else if((window.orientation==180||window.orientation==0)){
				// }
				if(wWidth > wHeight){
					wWidth = wHeight;
				}
				wFsize = wWidth > 1080 ? 144 : wWidth / 7.5;
				wFsize = wFsize > 32 ? wFsize : 32;
				window.screenWidth_ = wWidth;
				if(isYIXIN || is2345 || ishaosou || isSogou || isLiebao || isGnbr){//YIXIN 和 2345 这里有个刚调用系统浏览器时候的bug，需要一点延迟来获取
					setTimeout(function(){
						wWidth = (screen.width > 0) ? (window.innerWidth >= screen.width || window.innerWidth == 0) ? screen.width : window.innerWidth : window.innerWidth;
						wHeight = (screen.height > 0) ? (window.innerHeight >= screen.height || window.innerHeight == 0) ? screen.height : window.innerHeight : window.innerHeight;
						wFsize = wWidth > 1080 ? 144 : wWidth / 7.5;
						wFsize = wFsize > 32 ? wFsize : 32;
						// document.getElementsByTagName('html')[0].dataset.dpr = wDpr;
						document.getElementsByTagName('html')[0].style.fontSize = wFsize + 'px';
						document.getElementById("fixed").style.display="none";
					},500);
				}else{
					// document.getElementsByTagName('html')[0].dataset.dpr = wDpr;
					document.getElementsByTagName('html')[0].style.fontSize = wFsize + 'px';
					//document.getElementById("fixed").style.display="none";
				}
				// alert("fz="+wFsize+";dpr="+window.devicePixelRatio+";UA="+uAgent+";width="+wWidth+";sw="+screen.width+";wiw="+window.innerWidth+";wsw="+window.screen.width+window.screen.availWidth);
			}
			resizeRoot();
		})();
		
	var guess = {
		init: function(){
			var _this = this;
			this.start = $("#start");
			this.checkBoard = $('#checkBoard');
			this.userLevel = '';
			this.start01 = $("#start01");
			this.start02 = $("#start02");
			this.start03 = $("#start03");
			this.wbegin = $('#wbegin');
			this.wbegin05 = $('#wbegin05');
			this.content = $('#main');
			this.endPage = $('#wend');
			this.selectbox = $('#selects_box');
			this.timeSpan = $('.time .num');
			this.rect = $('.rect');
			this.again = $(".again");
			this.fx = $(".fx");
			this.qiandao = $(".qiandao");
			this.board = $(".board");
			this.qiandaoPage = $('#qiandao');
			this.boardPage = $('#board');
			this.timer = null;
			this.music = null;
			this.musicRotate = 0;
			this.musicState = 0;
			this.time = 60;
			this.finishQue = 0;
			this.count = 0;
			this.needAnswer = 40;
			this.updateTime = 1500;
			this.updateTimeState = 1100;
			this.nameArr = [];
			this.level = 1;
			this.index = 0; //正确答案索引
			//this.several = 0;
			this.firstQueue = [{"answer":"牢记使命","question":"十九大主题是：不忘初心，_____。","answers":["砥砺前行","牢记使命","继续前进"]},
							{"answer":"中高速","question":"我国经济已经进入_____增长期。","answers":["中高速","超速","稳定"]},
							{"answer":"主战","question":"军队改革形成军委管总，战区_____，军种主建新格局。","answers":["配合","宣战","主战"]},
							{"answer":"管治权","question":"中央拥有对香港、澳门的全面_____。","answers":["管治权","保护权","执法权"]},
							{"answer":"八","question":"中央出台_____项规定，严整形式主义、官僚主义、享乐主义和奢靡之风。","answers":["五","七","八"]},
							{"answer":"强起来","question":"中华民族迎来了从站起来、富起来到_____的飞跃。","answers":["强起来","世界第一","走出去"]},
							{"answer":"新时代","question":"中国特色社会主义进入_____。","answers":["新时代","新征程","下半场"]},
							{"answer":"不平衡不充分","question":"我国社会主要矛盾已经转化为人民日益增长的美好生活需要和_____的发展之间的矛盾。","answers":["低收入","不平衡不充分","低质量"]},
							{"answer":"处于并将长期处于","question":"我国_____社会主义初级阶段。","answers":["处于并将长期处于","不再处于","即将走过"]},
							{"answer":"中华民族伟大复兴","question":"中国共产党的历史使命是实现_____。","answers":["中华民族伟大复兴","共产主义","国家富强"]},
							{"answer":"雄安新区","question":"推动京津冀协同发展，高起点规划、高标准建设____。","answers":["北京新机场","通州区","雄安新区"]},
							{"answer":"腐败","question":"_____是我们党面临的最大威胁。","answers":["腐败","享乐之风","执法不严"]},
							{"answer":"依然严峻复杂","question":"当前，反腐败斗争形势_____。","answers":["依然严峻复杂","不太乐观","基本稳定"]},
							{"answer":"是用来住的、不是用来炒","question":"要坚持房子____的定位，让全体人民住有所居。","answers":["是用来住的、不是用来炒","是用租的、不是用买","是用来住的、不是用来炫富"]},
							{"answer":"一国两制","question":"坚持______，推进祖国统一。","answers":["一国两制","平等协商","四项基本原则"]},
							{"answer":"一带一路","question":"坚持打开国门搞建设，积极促进______国际合作。","answers":["一带一路","一路一带","Oneworld onedream"]},
							{"answer":"中华民族伟大复兴","question":"新时代中国特色社会主义思想，总任务是实现社会主义现代化和_______。","answers":["工业化","世界第一","中华民族伟大复兴"]},
							{"answer":"社会主义现代化","question":"到2035年，要基本实现____。","answers":["社会主义现代化","第二步走","共同富裕"]},
							{"answer":"2035","question":"“两个一百年”的第二阶段是从____年到本世纪中叶。","answers":["2018","2020","2035"]},
							{"answer":"绿水青山就是金山银山","question":"建设生态文明，必须树立和践行____的理念。","answers":["宁弃金山银山也要绿水青山","绿水青山就是金山银山","舍得放弃金山银山"]},
							{"answer":"两步","question":"在全面建成小康社会的基础上，分____在本世纪中叶建成社会主义现代化强国。","answers":["两步","三步","四步"]},
							{"answer":"留置","question":"“两规”措施被_____措施取代。","answers":["逮捕","留置","拘役"]},
							{"answer":"人才","question":"_____是实现民族振兴、赢得国际竞争主动的战略资源。","answers":["人才","教育","校园"]},
							{"answer":"石榴籽","question":"加强各民族交往交流交融，促进各民族像____一样紧紧抱在一起。","answers":["玉米粒","石榴籽","橘子瓣"]},
							{"answer":"抉择","question":"世界命运握在各国人民手中，人类前途系于各国人民的______。","answers":["爱好","运气","抉择"]},
							{"answer":"全球治理体系","question":"中国将继续发挥负责任大国作用，积极参与______改革和建设。","answers":["联合国","全球治理体系","其他国家的"]},
							{"answer":"战斗力","question":"军队是要准备打仗的，一切工作都必须坚持______标准。","answers":["听指挥","政治第一","战斗力"]},
							{"answer":"独立自主","question":"中国坚定奉行______的和平外交政策，尊重各国人民自主选择发展道路的权利。","answers":["独立自主","不结盟","不干涉"]},
							{"answer":"党","question":"党政军民学，东西南北中，____是领导一切的。","answers":["党","人大","政府"]},
							{"answer":"吃得放心","question":"实施食品安全战略，让人民____。","answers":["吃得放心","身体健康","吃出美味"]},
							{"answer":"财产性","question":"要拓宽居民劳动收入和____收入渠道。","answers":["炒股","财产性","投资"]},
							{"answer":"以药养医","question":"全面取消____，健全药品供应保障制度。","answers":["以药养医","医生收红包","药贩子"]},
							{"answer":"不想腐","question":"反腐败要让腐败分子不敢腐、不能腐、_____。","answers":["没空腐","不想腐","没机会腐"]},
							{"answer":"敲锣打鼓","question":"中华民族的伟大复兴，绝不是轻轻松松_____就能实现的。","answers":["异想天开","敲锣打鼓","安安稳稳"]},
							{"answer":"改旗易帜","question":"既不能走封闭僵化的老路，也不能走_____的邪路。","answers":["改旗易帜","颠三倒四","胡思乱想"]},
							{"answer":"城市群","question":"要以_____为主体构建大中小城市和小城镇协调发展的城镇格局。","answers":["城市群","北上广","大城市"]},
							{"answer":"全国统筹","question":"完善城镇职工基本养老保险和城乡居民基本养老保险制度，尽快实现养老保险____。","answers":["异地报销","互通有无","全国统筹"]},
							{"answer":"绿色低碳","question":"倡导简约适度、______的生活方式，反对奢侈浪费和不合理消费。","answers":["绿色低碳","能省就省","艰苦朴素"]},
							{"answer":"战略支援部队","question":"建设强大的现代化陆军、海军、空军、火箭军和______。","answers":["海军陆战部队","战略支援部队","空降部队"]},
							{"answer":"高中阶段","question":"办好学前教育、特殊教育和网络教育，普及____教育。","answers":["高中阶段","免费","职业"]}];
			
			this.secondQueue = [{"answer":"监察","question":"北京、山西、浙江三地_____体制改革试点取得实效。","answers":["监察","检查","检察"]},
								{"answer":"供给侧","question":"经济结构不断优化，_____改革不断推进。","answers":["消费侧","需求侧","供给侧"]},
								{"answer":"宪法","question":"中国特色社会主义法律体系以____为核心。","answers":["宪法","党章","十九大报告"]},
								{"answer":"“一带一路”建设","question":"推动形成全面开放新格局，要以_____为重点。","answers":["“一带一路”建设","改革开放","引进外资"]},
								{"answer":"全部","question":"确保到2020年我国贫困县____摘帽。","answers":["基本","半数","全部"]},
								{"answer":"创造美好生活","question":"带领人民____，是我们党始终不渝的奋斗目标。","answers":["创造美好生活","干事业","奔小康"]},
								{"answer":"人民","question":"____是历史的创造者，是决定党和国家前途命运的根本力量。","answers":["知识分子","人民","无产阶级"]},
								{"answer":"增进民生福祉","question":"____是发展的根本目的。","answers":["增进民生福祉","国家富强","提高国际地位"]},
								{"answer":"人口老龄化","question":"实施健康中国战略，积极应对____。","answers":["人口红利削减","环境污染","人口老龄化"]},
								{"answer":"美丽","question":"到本世纪中叶，要把我国建成富强民主文明和谐____的社会主义现代化强国。","answers":["稳定","开放","美丽"]},
								{"answer":"2020","question":"从现在到____年，是全面建成小康社会的决胜期。","answers":["2020","2030","2046"]},
								{"answer":"“九二共识”","question":"必须坚持一个中国原则，坚持____，推动两岸关系和平发展。","answers":["“九二共识”","“一国两制”","反对“台独”"]},
								{"answer":"宪法法律","question":"任何组织和个人都不得有超越____的特权。","answers":["公序良俗","宪法法律","人民利益"]},
								{"answer":"现代化","question":"要把教育事业放在优先位置，加快教育____，办好人民满意的教育。","answers":["免费","现代化","普及"]},
								{"answer":"人类进步事业","question":"中国共产党是为中国人民谋幸福的政党，也是为______而奋斗的政党。","answers":["人类进步事业","世界人民大团结","理想"]},
								{"answer":"绝不允许","question":"我们______任何人、任何组织、任何政党、在任何时候、以任何形式、把任何一块中国领土从中国分裂出去！","answers":["声讨","绝不允许","质疑"]},
								{"answer":"蓝天","question":"持续实施大气污染防治行动，打赢_____保卫战。","answers":["雾霾","绿水","蓝天"]},
								{"answer":"市场","question":"构建以______为导向的绿色技术创新体系。","answers":["计划","市场","结果"]},
								{"answer":"发展","question":"实现中华民族伟大复兴，必须把_____作为党执政兴国的第一要务。","answers":["发展","保增长","反腐"]},
								{"answer":"喘口气、歇歇脚","question":"全面从严治党永远在路上，绝不能有任何_____的念头。","answers":["喘口气、歇歇脚","见好就收","打退堂鼓"]},
								{"answer":"两岸一家亲","question":"秉持_____理念，尊重台湾现有的社会制度和台湾同胞生活方式。","answers":["不干涉","两岸一家亲","和平"]},
								{"answer":"就业","question":"____是最大的民生。","answers":["就业","扶贫","发展"]},
								{"answer":"同步","question":"坚持在经济增长的同时实现居民收入____增长。","answers":["翻倍","较快","同步"]},
								{"answer":"实体","question":"必须把发展经济的着力点放在_____经济上。","answers":["互联网","虚拟","实体"]},
								{"answer":"疏解北京非首都功能","question":"要以_____为“牛鼻子”推动京津冀协同发展。","answers":["疏解北京非首都功能","扩大城市群","强化北京非首都功能"]},
								{"answer":"脱离群众","question":"我们党一旦_____就会失去生命力。","answers":["脱离群众","监督不力","执法不力"]},
								{"answer":"创新","question":"_____是引领发展的第一动力。","answers":["苦干","想象力","创新"]},
								{"answer":"中国化","question":"新时代中国特色社会主义思想，是马克思主义____最新成果。","answers":["进化","中国化","国际化"]},
								{"answer":"农业农村农民","question":"_____问题是关系国计民生的根本性问题。","answers":["农业","农业农村农民","农民"]},
								{"answer":"党的干部","question":"_____是党和国家事业的中坚力量。","answers":["人民群众","普通党员","党的干部"]},
								{"answer":"生态文明","question":"建设_____是中华民族永续发展的千年大计。","answers":["生态文明","南水北调","雄安新区"]},
								{"answer":"国家公园","question":"构建国土空间开发保护制度，建立以_____为主体的自然保护地体系。","answers":["各地政府","国家公园","企业"]},
								{"answer":"强军","question":"坚持富国和______相统一，深化国防科技工业改革。","answers":["强军","富民","中国梦"]},
								{"answer":"多样性","question":"构建生态廊道和生物______保护网络，提升生态系统质量和稳定性。","answers":["多样性","单一性","复杂性"]},
								{"answer":"最关心最直接最现实","question":"保障和改善民生，就要抓住人民____的利益问题。","answers":["最关心最直接最现实","意见最大","呼声最高"]},
								{"answer":"人类命运共同体","question":"中国特色大国外交要推动构建新型国际关系，推动构建____。","answers":["一带一路","人类命运共同体","国家朋友圈"]},
								{"answer":"社会主义现代化强国","question":"从全面建成小康社会到基本实现现代化，再到全面建成____，是新时代中国特色社会主义发展的战略安排。","answers":["社会主义现代化强国","世界第一强国","工业强国"]},
								{"answer":"人工智能","question":"加快发展先进制造业，推动互联网、大数据、____和实体经济深度融合。","answers":["电商","人工智能","手机支付"]},
								{"answer":"共享经济","question":"在中高端消费、创新引领、绿色低碳、____等领域培育新增长点。","answers":["共享经济","装配式住宅","物流"]},
								{"answer":"共抓大保护、不搞大开发","question":"长江经济带以____为导向。","answers":["高强度开发","航运+生态","共抓大保护、不搞大开发"]}];
			
			this.thirdQueue = [{"answer":"看齐","question":"四个意识是：政治意识、大局意识、核心意识、_____意识。","answers":["民主","看齐","集中"]},
								{"answer":"6000","question":"十八大以来我国已有_____万贫困人口稳定脱贫。","answers":["600","6000","60"]},
								{"answer":"1500","question":"五年来中央共推出_____项改革举措。","answers":["150","1500","15000"]},
								{"answer":"80","question":"过去五年我国GDP从54万亿元增长到_____万亿元。","answers":["55","80","200"]},
								{"answer":"世界舞台中央","question":"我国日益走近_____，不断为人类做出更大贡献。","answers":["现代化","新时代","世界舞台中央"]},
								{"answer":"文化自信","question":"我们要增强道路自信、理论自信、制度自信和_____。","answers":["文化自信","事业自信","品牌自信"]},
								{"answer":"伟大斗争","question":"实现伟大梦想，必须进行_____。","answers":["科学规划","理论创新","伟大斗争"]},
								{"answer":"更高质量","question":"要坚持就业优先战略和积极就业政策，实现____和更充分就业。","answers":["更高报酬","更多人群","更高质量"]},
								{"answer":"中国共产党领导","question":"中国特色社会主义制度的最大优势是____。","answers":["中国共产党领导","人民民主专政","以人为本"]},
								{"answer":"知识","question":"我国需要建设_____型、技能型、创新型的劳动者大军。","answers":["知识","密集","务实"]},
								{"answer":"系统性金融风险","question":"健全金融监管体系需要守住不发生_____的底线。","answers":["系统性金融风险","外储流失","股市大跌"]},
								{"answer":"产权","question":"经济体制改革必须以完善_____制度及要素市场化配置为重点。","answers":["经济","承包","产权"]},
								{"answer":"政治","question":"党的_____建设是党的根本性建设，决定党的建设方向和效果。","answers":["政治","文化","廉政"]},
								{"answer":"基层组织","question":"党的_____是确保党的路线方针政策和决策部署贯彻落实的基础。","answers":["基层组织","监督机构","执法机构"]},
								{"answer":"中国化","question":"坚持我国宗教的____方向，积极引导宗教与社会主义社会相适应。","answers":["多元化","国际化","中国化"]},
								{"answer":"渗透颠覆破坏","question":"严密防范和坚决打击各种____活动、暴力恐怖活动、民族分裂活动、宗教极端活动。","answers":["盗窃","渗透颠覆破坏","传销"]},
								{"answer":"生态文明","question":"加快_____体制改革，建设美丽中国。","answers":["生态文明","环境文明","环保文明"]},
								{"answer":"保护自然","question":"人与自然是生命共同体，人类必须尊重自然、顺应自然、______。","answers":["保护自然","改造自然","掌控自然"]},
								{"answer":"群众监督","question":"增强党自我净化能力，根本靠强化党的自我监督和_____。","answers":["群众监督","相互监督","媒体监督"]},
								{"answer":"血肉联系","question":"加强作风建设必须紧紧围绕保持党同人民群众的_____。","answers":["良好互动","血肉联系","一般联系"]},
								{"answer":"自我革命","question":"勇于____，从严管党治党，是中国共产党最鲜明的品格。","answers":["自我检讨","自我开发","自我革命"]},
								{"answer":"2035","question":"力争到______基本实现国防和军队现代化。","answers":["2018年","2046年","2035"]},
								{"answer":"现实","question":"加强____题材创作，不断推出讴歌党、讴歌祖国、讴歌人民、讴歌英雄的精品力作。","answers":["传统文化","现实","生活"]},
								{"answer":"香港、澳门同胞","question":"让______同祖国人民共担民族复兴的历史责任、共享祖国繁荣富强的伟大荣光。","answers":["香港、澳门同胞","海外侨胞","台湾同胞"]},
								{"answer":"新时代中国特色社会主义思想","question":"我们应该用_____武装全党。","answers":["新时代中国特色社会主义思想","先进科技知识","国际文化"]},
								{"answer":"一视同仁、平等对待","question":"保护外商投资合法权益,凡是在我国境内注册的企业，要_____。","answers":["严格审查其背景","更高标准提出环保要求","一视同仁、平等对待"]},
								{"answer":"混合所有制","question":"深化国企改革，发展_____经济，培育具有全球竞争力的世界一流企业。","answers":["公有制","混合所有制","市场"]},
								{"answer":"获得感","question":"五年来，随着一大批惠民举措落地实施，人民____显著增强。","answers":["自豪感","获得感","便利感"]},
								{"answer":"有事好商量，众人的事情由众人商量","question":"____，是人民民主的真谛。","answers":["和谐","少数服从多数","有事好商量，众人的事情由众人商量"]},
								{"answer":"每一个司法案件中","question":"深化依法治国实践，要努力让人民群众在____感受到公平正义。","answers":["每一个司法案件中","上级政府的关怀中","团结和民主中"]},
								{"answer":"2020年","question":"提高军队建设质量和效益，确保到______基本实现机械化，信息化建设取得重大进展。","answers":["2050年","2020年","2018年"]},
								{"answer":"统一战线","question":"____是党的事业取得胜利的重要法宝，必须长期坚持。","answers":["理论建设","统一战线","自我革新"]},
								{"answer":"合并设立或合署办公","question":"在省市县,对职能相近的党政机关探索_____。","answers":["合并设立或合署办公","大部制","扩编"]},
								{"answer":"无禁区、全覆盖、零容忍","question":"巩固反腐败斗争压倒性态势，要坚持____。","answers":["无禁区、全覆盖、零容忍","纪律学习","思想教育"]},
								{"answer":"全民参保","question":"加强社会保障体系建设，全面实施____计划。","answers":["全民参保","延迟退休","以房养老"]},
								{"answer":"公仆","question":"各级领导干部要增强民主意识，接受人民监督，当好人民____。","answers":["代表","公仆","父母官"]},
								{"answer":"发展不平衡不充分","question":"我国社会生产能力在很多方面进入世界前列，更加突出的问题是____。","answers":["工资不够","高质量不够好","发展不平衡不充分"]},
								{"answer":"民营企业","question":"清理废除妨碍统一市场和公平竞争的各种规定，支持____发展，激发各类市场主体活力。","answers":["民营企业","外资企业","个人创业者"]},
								{"answer":"教育强国","question":"建设____是中华民族伟大复兴的基础工程，必须放在优先位置。","answers":["美好环境","教育强国","公路铁路"]},
								{"answer":"高度的文化自信","question":"没有____，没有文化的繁荣兴盛，就没有中华民族伟大复兴。","answers":["高度的文化自信","充分的文化传承","先进的文化理念"]}];
			this.quiz = null; // current best quiz record
			this.isCheckBoard = false;
			// load question levels from server
			$.getJSON('/questionlevels', {active: true}).done(json => {
				console.log('get /questionlevels success')
				var l1 = -1, l2 = -1, l3 = -1;
				json.forEach((v, i) => {
					if (v.level == 1) {
						l1 = i;
					} else if (v.level == 2) {
						l2 = i;
					} else if (v.level == 3) {
						l3 = i;
					}
				});
				if (l1 !== -1 && json[l1].questions.length > 0) {
					console.log('use level 1 questions');
					this.firstQueue = json[l1].questions;
				}
				if (l2 !== -1 && json[l2].questions.length > 0) {
					console.log('use level 2 questions');
					this.secondQueue = json[l2].questions;
				}
				if (l3 !== -1 && json[l3].questions.length > 0) {
					console.log('use level 3 questions');
					this.thirdQueue = json[l3].questions;
				}
			});
			this.start01.on('click', function(){
				var that = this;
				$(this).find("img").animate({"marginTop":"0.1rem"},300,function(){
					$(that).find("img").animate({"marginTop":"0rem"},300);
				});
				_this.checkSubmitted(1);
				setTimeout(function(){
					_this.wbegin05.hide();
					_this.content.show();
					_this.level = 1;
					_this.count = 0;
					_this.gameInit(_this.level);
				},600);
			 
			});
			this.start02.on('click', function(){
				var that = this;
				$(this).find("img").animate({"marginTop":"0.1rem"},300,function(){
					$(that).find("img").animate({"marginTop":"0rem"},300);
				});
				_this.checkSubmitted(2);
				setTimeout(function(){
					_this.wbegin05.hide();
					_this.content.show();
					_this.level = 2;
					_this.count = 0;
					_this.gameInit(_this.level);
				},600);
			});
			this.start03.on('click', function(){
				var that = this;
				$(this).find("img").animate({"marginTop":"0.1rem"},300,function(){
					$(that).find("img").animate({"marginTop":"0rem"},300);
				});
				_this.checkSubmitted(3);
				setTimeout(function(){
					_this.wbegin05.hide();
					_this.content.show();
					_this.level = 3;
					_this.count = 0;
					_this.gameInit(_this.level);
				},600);
			});
			
			this.start.on('click', function(){
				//document.getElementById("audioBg").volume = 0.3;
				var that = this;
				$(this).animate({"bottom":"0.4rem"},300,function(){
					$(that).animate({"bottom":"0.5rem"},300);
				});
				setTimeout(function(){
					_this.wbegin.hide();
					_this.wbegin05.show();
					$(that).css({"bottom":"0.5rem"});
				},600);
				
				if(_this.musicState){
					document.getElementById("audioBg").play();
					if(!_this.music){
						_this.music = setInterval(function(){
							_this.musicRotate++;
							if(_this.musicRotate==360){
								_this.musicRotate = 0;
							}
							$(".music").css({"transform":"rotateX("+_this.musicRotate+"deg)"});
						},30);										
					}
				}
				console.log(_this.musicState);
			  
			});
			this.checkBoard.on('click', function () {
				var that = this;
				$(this).animate({"bottom": "0.4rem"}, 300, function () {
					$(that).animate({"bottom": "0.5rem"}, 300);
				});
				_this.isCheckBoard = true;
				setTimeout(function() {
					_this.boardPage.show();
					_this.wbegin.hide();
					_this.loadBoards();
					$(that).css({"bottom": "0.5rem"});
				}, 600);
			});
			this.again.on('click', function(){
				_this.count = 0;
				_this.userLevel = '';
				_this.timeSpan.html(_this.time);
				_this.finishQue = 0;
				_this.setCookie("several",1,10);
				_this.wbegin05.show();
				_this.endPage.hide();
				window.location.reload();
			});
			this.fx.on('click', function(){
				$(".mask2").show();
				
				$(".fxtips").show();
				setTimeout(function(){
					$(".mask2").hide();
					$(".fxtips").hide();
				},5000);
			});
			this.qiandao.on('click', function() {
				if (_this.quiz && _this.quiz.score >= _this.count) {
					_this.message('很遗憾，这次挑战没有超越自己的最好成绩'+ _this.quiz.score + '个，继续加油吧！');
					return;
				}
				// init form using current quiz
				var phone = '';
				var organizationId = '';
				if (_this.quiz) {
					phone = _this.quiz.phone || '';
					organizationId = _this.quiz.organizationId || '';
				} else {
					phone = window.phoneNum;
					organizationId = window.organizationId;
				}
				$('#qiandao form input').val(phone);
				$('#qiandao form select').val(organizationId);
				_this.qiandaoPage.show();
				_this.endPage.hide();
			});
			this.board.on('click', function() {
				_this.isCheckBoard = false;
				_this.boardPage.show();
				_this.endPage.hide();
				_this.loadBoards();
			});
			$('.box06 .buttons .return').on('click', function() {
				_this.endPage.show();
				_this.qiandaoPage.hide();
			});
			$('.box06 .buttons .submit').on('click', _this.doQiandao());
			$('.box07 .buttons .return').on('click', function(){
				if (_this.isCheckBoard) {
					_this.wbegin.show();
				} else {
					_this.endPage.show();
				}
				_this.boardPage.hide();
			});
			$('.box07 #geren').on('click', function () {
				$('.box07 .roller').show();
				$('.box07 .orgRoller').hide();
				_this.boardPage.removeClass('zuzhi');
			});
			$('.box07 #zuzhi').on('click', function () {
				$('.box07 .orgRoller').show();
				$('.box07 .roller').hide();
				_this.boardPage.addClass('zuzhi');
			});
			$('.box06 form #phone').on('change', (e) => {
				var v = $('.box06 form #phone').val();
				_this.validPhone(v);
			});
			$(".music").on('click',function(){
				if(_this.musicState){
					_this.musicState = 0;
					clearInterval(_this.music);
					
					$(".music").css({"transform":"rotateX(0deg)", "background":"url(http://image.cmlzw.net/19da/music_stop.png) 0 0/100% auto no-repeat"});
					document.getElementById("audioBg").pause();
				}else{
					_this.musicState = 1;
					//document.getElementById("audioBg").volume = 0.3;
					$(".music").css({"background":"url(http://image.cmlzw.net/19da/music_start.png) 0 0/100% auto no-repeat"});
					_this.music = setInterval(function(){
						_this.musicRotate++;
						if(_this.musicRotate==360){
							_this.musicRotate = 0;
						}
						$(".music").css({"transform":"rotateX("+_this.musicRotate+"deg)"});
					},30);
					document.getElementById("audioBg").play();
				}
			});
			setTimeout(function(){
				_this.mobileHeight();
				$(".remain").css({"width":_this.time+"%"});
				$(".box01 .fingers").animate({"width":"7.5rem","marginLeft":"-3.75rem"},500,function(){
					$(".box01 .fingers").animate({"width":"6.8rem","marginLeft":"-3.4rem"},500,function(){
						$(".box01 .fingers").animate({"width":"7.5rem","marginLeft":"-3.75rem"},500,function(){
							$(".box01 .fingers").animate({"width":"6.8rem","marginLeft":"-3.4rem"},500);
						});
					});
				});
				if(!_this.musicState){
					$(".music").css({"background":"url(http://image.cmlzw.net/19da/music_stop.png) 0 0/100% auto no-repeat"});
				}
			},100);
			//console.log(this.getCookie("several"));
			if(this.getCookie("several")){
				this.wbegin.hide();
				this.wbegin05.show();
			}

		},
		validPhone: function (v) {
			v = v.trim();
			if (!v.match(/^1\d{10}$/)) {
				$('.box06 form #phoneErr').text('手机号无效');
				return false;
			} else {
				$('.box06 form #phoneErr').text('');
				return true;
			}
		},
		doQiandao: function () {
			var _this = this;
			return () => {
				var org = $('#qiandao form select').val() || undefined;
				var phone = $('#qiandao form input').val();
				if (!phone) {
					_this.message('请您提供手机号，以便我们及时通知您得奖情况。')
					return;
				}
				if (!_this.validPhone(phone)) {
					return;
				}
				var quiz = {
					level: _this.level,
					username: window.username,
					organizationId: org,
					phone: phone,
					score: _this.count
				}
				if (_this.quiz) {
					// only update score
					if (quiz.score > _this.quiz.score) {
						$.ajax({
							type: 'PUT',
							url: '/quizzes/' + _this.quiz.id,
							data: JSON.stringify(quiz),
							contentType: 'application/json;charset=utf8'
						}).done((data, status) => {
							_this.message('成功更新答题成绩，随时等候您来提交自己的更好成绩奥。')
						});
					}
					return;
				}
				// submit a new quiz
				$.ajax({
					type: 'POST',
					url: '/quizzes',
					data: JSON.stringify(quiz),
					contentType: 'application/json;charset=utf8'
				}).done((data, status) => {
					window.phoneNum = quiz.phone;
					window.organizationId = quiz.organizationId || '';
					_this.message('答题成绩提交成功，随时等候您来提交自己的更好成绩奥。')
					// note: always allow submit many times
					// $('.box06 .buttons .submit').off('click');
					// _this.qiandao.off('click');
					// $('.box03 .qiandao').addClass('disabled');
					_this.endPage.show();
					_this.qiandaoPage.hide();
					window.submitted = true;
				}).fail((xhr, status, error) => {
					if (xhr.status === 400) {
						console.log('User ' + window.username + ' has submitted today.');
						_this.message('您今天这个级别已经签到了，挑战一下其他级别吧！');
					} else {
						console.log('post quizzes failed: ' + JSON.stringify({status: status, error: error}));
						_this.message('啊呀，监考老师溜号了，请稍后再来提交试试。');
					}
				});
			};
		},
		checkSubmitted: function (level) {
			// note: always allow submit many times only when the new score is better
			var _this = this;
			$.getJSON('/quizzes/' + window.username + '/' + level).done(json => {
				console.log('user ' + window.username + ' has a quiz at level ' + level + ', score: ' + json.score);
				_this.quiz = json;
			}).fail((xhr, status, error) => {
				console.log('get the best quiz at level ' + level + ' failed: ' + status);
				_this.quiz = null;
			});
			// var _this = this;
			// // determine if user had submitted score
			// $.getJSON('/quizzes/' + window.username + '/' + level).done(json => {
			// 	console.log('user ' + window.username + ' has submitted quiz{id:' + json.id + ',level:' + json.level + '}');
			// 	$('.box06 .buttons .submit').off('click');
			// 	$('.box03 .buttons .qiandao').off('click');
			// 	$('.box03 .buttons .qiandao').addClass('disabled');
			// }).fail((xhr, status, error) => {
			// 	if (xhr.status === 404) {
			// 		$('.box03 .buttons .qiandao').removeClass('disabled');
			// 		$('.box03 .buttons .qiandao').unbind('click');
			// 		$('.box03 .buttons .qiandao').on('click', () => {
			// 			_this.qiandaoPage.show();
			// 			_this.endPage.hide();
			// 		});
			// 		$('.box06 .buttons .submit').unbind('click');
			// 		$('.box06 .buttons .submit').on('click', _this.doQiandao());
			// 		console.log('user ' + window.username + ' can submit score today');
			// 	}
			// });
		},
		getCookie: function(c_name)
		{
			if (document.cookie.length>0)
			{
				c_start=document.cookie.indexOf(c_name + "=")
				if (c_start!=-1)
				{ 
					c_start=c_start + c_name.length+1;
					c_end=document.cookie.indexOf(";",c_start);
					if (c_end==-1) c_end=document.cookie.length;
					return unescape(document.cookie.substring(c_start,c_end));
				} 
			}
			return "";
		},
		setCookie: function(c_name,value,seconds)
		{
			var exdate=new Date();		
			exdate.setTime(exdate.getTime()+(seconds*1000)); 
			document.cookie=c_name+ "=" +escape(value)+";path=/"+((seconds==null) ? "" : ";domain=cmlzw.net;expires="+exdate.toGMTString());
		},
		gameInit: function(){
			
			var _this = this;
			this.selectbox.off('click');
			//console.log(this.level);
			//alert(1)
			this.createPage();
			
			this.timeSpan.html(_this.time); 
			//递减数秒  
			//if(!this.several){
			clearInterval(this.timer);
				this.countdown();
			//}
			
			//this.fillContent();
      
		},
		createPage : function(){
			//console.log(this.firstQueue);
			var _this = this;
			this.rect.removeClass('err').removeClass('cor');
			
			$(".correct").hide();
			$(".error").hide();
			if (this.level==1){
			
					this.showName = this.getRand(_this.firstQueue);
					 //更新name obj数组，防止重复出现http://upload.cankaoxiaoxi.com/2017/1102/1509607624735.mp3
					 this.firstQueue = this.showName.newData;
			}else if(this.level==2){
			
					this.showName = this.getRand(_this.secondQueue);
					 //更新name obj数组，防止重复出现
					 this.secondQueue = this.showName.newData;
			}else if(this.level==3){
				
					this.showName = this.getRand(_this.thirdQueue);
					 //更新name obj数组，防止重复出现
					 this.thirdQueue = this.showName.newData;
			}
			this.fillContent();
		},

		getRand : function(data){
			var info = {},
				arr = [],
				copyarr = [];
			//复制数组
			var copydata = copyarr.concat(data);

			var randNum = Math.floor(Math.random() * copydata.length);

			arr = copydata.splice(randNum,1)[0];

			info['newData'] = copydata;
			info['arr'] = arr;
			return info;
		},
		
		fillContent : function(){
			var _this = this,
			randpos = Math.floor(Math.random()*4),
			pepoleName = this.showName.arr.answer,
			question = this.showName.arr.question;
			
			$("#question").html(question);
			//resultArr = this.result.arr;//随机取出的4个名字
			resultArr = this.showName.arr.answers;
			resultArr.sort(function(){ return 0.5 - Math.random(); });
			
			$(resultArr).each(function(k,v){
				//$('#s_'+k).html(v);
				if(v == pepoleName){
					_this.index = k;
					$('#s_'+k).html(v+'<div class="correct"><span class="tip">+1s</span></div>');
				}else {
					$('#s_'+k).html(v+'<div class="error"><span class="tip">-'+_this.level+'s</span></div>');
				}
			});
			$('#s_3').html('求答案<div class="error"></div>');
			//如果不包含答案，就随机替换
			
			if($.inArray(pepoleName,resultArr) < 0){
			$('#s_'+randpos).html(pepoleName); 
			} 
			this.isRight(pepoleName);
			// console.log(pepoleName);
		},
	 
		mobileHeight: function(){
			var height  = this.isDesktop ? 1000 : ((window.innerWidth>window.innerHeight?window.innerWidth:window.innerHeight));
			height = height + 'px';
			$(".wrap").css('height', height);
		},
		isRight : function(pepoleName){
			
			var _this = this;
			this.selectbox.on('click', '.rect', function(){
				//alert($(this).html())
				_this.finishQue++;
				document.getElementById("audioPlay").play();
				if($(this).html().indexOf(pepoleName)>=0){
					_this.adjustTime(1, true);
					_this.selectbox.off('click');
					_this.count++;
					$(".correct").show();
					$(this).css({"transform":"rotateX(-90deg) translateY(0px)"});
					
					setTimeout(function(){
						document.getElementById("audioRight").play();
					},200);
				}else{
					if($(this).html().indexOf("求答案")<0){
						_this.adjustTime(-_this.level, true);
					}
					
					_this.selectbox.off('click'); 
					$(this).find(".error").show();
					$('#selects_box li:eq('+_this.index+')').addClass("cor");
					$(this).css({"transform":"rotateX(-90deg) translateY(0px)"});
					
					setTimeout(function(){
						document.getElementById("audioWrong").play();
					},200);

				}
				$(this).find(".tip").css({"opacity":1});
				setTimeout(function(){_this.rect.css({"transform":"rotateX(0deg) translateY(0px)"}).removeClass('err').removeClass('cor'); _this.rect.find(".tip").css({"opacity":0});}, _this.updateTimeState);
				if(_this.finishQue>=_this.needAnswer){
					setTimeout(function(){_this.gameover()}, _this.updateTime); 
					return;
				}else{
					setTimeout(function(){_this.createPage();}, _this.updateTime);
				}

				//console.log(_this.finishQue);

			});       
		},
		countdown : function(){
		
			var _this = this;
			this.timer = setInterval(function(){
				
				var time = _this.timeSpan.html(),
				second = parseInt(time);

				if(second <= 0){
					_this.gameover(); 
					_this.selectbox.off('touchend'); 

				}else{
					second = second - 1;
					$(".remain").css({"width":second+"%"});
					_this.timeSpan.html(second);
					//用匿名函数传递this
					//this.timer = setTimeout(function(){_this.countdown()}, 1000);             
				}
				//console.log(-1);
			},1000);
			
		},
		adjustTime: function(number, method){
			var _this = this,
			time = this.timeSpan.html(),
			second = parseInt(time);
			if(method){
				second = second + parseInt(number);
			}else{
				second = parseInt(number);
			}
			if(parseInt(second)<=0){
				second = 0;
				this.gameover();
				return ;
			}
			$(".remain").css({"width":second+"%"});
			this.timeSpan.html(second);
		},
		gameover : function(){
			var _this = this;
			document.getElementById("audioBg").pause();
			$(".music").hide();
			if(_this.musicState){
				_this.musicState = 0;
				clearInterval(_this.music);
			}
			if(this.timer){
				clearInterval(this.timer);
				this.timer = null;
				console.log("yes");
			}

			$(".box03 .tip").css({"width":0,"height":0,"left":"50%","top":"4rem"});
			$(".box03 .tip .percent").hide();
			$(".box03 .tip .honor").hide();
			$(".box03 .tip .text").hide();
			
			$(".box03 .again").css({"marginLeft":"-6rem"});
			// $(".box03 .fx").css({"marginLeft":"6rem"});
			// $(".box03 .qiandao").css({"marginLeft":"-6rem"});
			// $(".box03 .board").css({"marginLeft":"6rem"});
			$(".box03 .qiandao").css({"marginLeft":"-6rem"});
			this.endPage.show();
			this.content.hide();
			document.getElementById("audioBg").pause();
			document.getElementById("audioOver").play();
			$(".box03 .tip").animate({"width":'90%',"height":"10rem","left":"5%","top":"2rem"},500,function(){
				// recalculate height to enable percentage layout
				var w = $(".box03 .tip").width();
				console.log('w: ' + w);
				var iw = 395;
				var ih = 272;
				var h = ih * w / iw;
				console.log('h: ' + h);
				console.log('ratio: ' + w/iw);
				$(".box03 .tip").height(h);

				$(".box03 .tip .percent").show();
				$(".box03 .tip .honor").show();
				$(".box03 .tip .text").show();
				$(".box03 .again").animate({"marginLeft": "0"}, 500);
				$(".box03 .qiandao").animate({"marginLeft": "0"}, 500,function() {
					var step = function(now) {
						$(".box03 .buttons .qiandao").css({
							transform: 'rotate(' + now + 'deg)'
						});
					};
					$({deg: 0}).animate({deg: 10}, {
						duration: 200,
						step: step
					}).animate({deg: -10}, {
						duration: 400,
						step: step
					}).animate({deg: 0}, {
						duration: 200,
						step: step
					});
				});
				// $(".box03 .again").animate({"marginLeft":"0"},500,function(){
				// 	$(".box03 .fx").animate({"marginLeft":"0"},500);
				// });
				// $(".box03 .qiandao").animate({"marginLeft":"0"},500,function(){
				// 	$(".box03 .board").animate({"marginLeft":"0"},500);
				// });
			});
				
			if(this.level==1){
				this.userLevel = "学民";
				if(this.count>=9){
					$(".box03 .tip .text").html("小胜别松懈，么么哒！");
					this.userLevel = "高级"+this.userLevel;
				}else if(this.count>=6){
					$(".box03 .tip .text").html("再不努力就悬啦！");
					this.userLevel = "中级"+this.userLevel;
				}else{
					$(".box03 .tip .text").html("还要继续学习哟，亲！");
					this.userLevel = "初级"+this.userLevel;
				}
			}else if(this.level==2){
				this.userLevel = "学霸";
				if(this.count>=9){
					$(".box03 .tip .text").html("学习达人，妥妥哒！");
					this.userLevel = "高级"+this.userLevel;
				}else if(this.count>=6){
					$(".box03 .tip .text").html("继续加油，还有机会！");
					this.userLevel = "中级"+this.userLevel;
				}else{
					$(".box03 .tip .text").html("别怕失败，有胆再来！");
					this.userLevel = "初级"+this.userLevel;
				}
			}else if(this.level==3){
				this.userLevel = "学神";
				if(this.count>=9){
					$(".box03 .tip .text").html("学神，我为你自豪！");
					this.userLevel = "高级"+this.userLevel;
				}else if(this.count>=6){
					$(".box03 .tip .text").html("小憩一下，再接再厉！");
					this.userLevel = "中级"+this.userLevel;
				}else{
					$(".box03 .tip .text").html("失败乃成功之母，依然看好你哟！");
					this.userLevel = "初级"+this.userLevel;
				}
			}
			
			$('.percent').html(this.count);
			$('.honor').html(this.userLevel);
			document.title = decodeURIComponent(window.nickname)+"在十九大知识问答中答对"+_this.count+"道题，获得"+this.userLevel+"称号！";
		},
		loadBoards () {
			var _this = this;
			var appendBoardLine = function ($parent, board) {
				$parent.empty();
				board.forEach((v, i) => {
					let nickname = null;
					if (v.user) {
						if (v.user.nickname) {
							nickname = v.user.nickname;
						}
					}
					if (nickname === null && v.phone) {
						nickname = v.phone.slice(0, 3) + '****' + v.phone.slice(-4);
					}
					if (nickname === null) {
						nickname =  '匿名';
					}
					$parent.append('<li><span class="nickname">' + nickname + '</span><span class="score">(' + v.score + ')</span></li>');
				});
			};
			$.getJSON('/quizzes/boards').done(json => {
				if (json[0] && json[0].length > 0) {
					appendBoardLine($('#xueminBoard'), json[0]);
				} else {
					$('#xueminBoard').empty();
					$('#xueminBoard').append('<li><p>还没有人上榜！</p></li>');
				}

				if (json[1] && json[1].length > 0) {
					appendBoardLine($('#xuebaBoard'), json[1]);
				} else {
					$('#xuebaBoard').empty();
					$('#xuebaBoard').append('<li><p>还没有人上榜！</p></li>');
				}

				if (json[2] && json[2].length > 0) {
					appendBoardLine($('#xueshenBoard'), json[2]);
				} else {
					$('#xueshenBoard').empty();
					$('#xueshenBoard').append('<li><p>还没有人上榜！</p></li>');
				}
			}).fail(() => {
				_this.message('亲，榜单开小差了，麻烦您一会儿再来。');
			});
			$.getJSON('/organizations').done(json => {
				$('#orgBoard').empty();
				if (json) {
					json.forEach((v, i) => {
						$('#orgBoard').append('<li><span class="seq">' + (i + 1) + '</span>'
							+ '<span class="nickname">' + v.name + '</span>'
							+ '<span class="score">' + (v.percent * 100).toFixed(2) + '%</span></li>')
					})
				} else {
					$('#orgBoard').append('<li><p>啊奥，怎么没有组织榜单呢？</p></li>');
				}
			}).fail(() => {
				_this.message('亲，榜单开小差了，麻烦您一会儿再来。')
			});
		},
		message (msg) {
			$('#message p').text(msg);
			$('#message').show();
			setInterval(() => {
				$('#message').hide();
			}, 5000);
		}

	};
	guess.init();

})(jQuery)
  
  </script>
  </body>
</html>